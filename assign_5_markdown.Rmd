---
title: "ESM206 Assignment 5"
author: "Teresa Fukuda"
date: "11/26/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
# Load packages and data

library(tidyverse)
library (stargazer)

grad_enroll <-read_csv("grad_enrollment.csv")
med_salary <-read_csv("median_salary_postdoc.csv")
phds <-read_csv("phds.csv")
salary_data <- read_csv("salary_data.csv")

```

```{r}
###############################################################
# 1) Male and female graduate enrollment (1967 - 2015)
###############################################################

# Creating a simplified data frame excluding non profit and for profit schools as well as irrelavent totals
grad_enroll_ftf <- grad_enroll %>% 
  select(Year, full_time_m, full_time_f, part_time_m, part_time_f)

```

```{r}
###############################################################
# 2) Shifts in female PhD recipients by field (1985, 2000, and 2015)
###############################################################
```

```{r}
###############################################################
# 3) Male and female salaries for starting postdoctoral and other employment positions (2015)
###############################################################
```

```{r}
###############################################################
# 4) Exploring academic salaries for professors in U.S. colleges
###############################################################

# Find a good multiple linear regression model with the output being salary, and the variables (some combination of) sex, discipline, rank, years of service, years since phd 

# Some data exploration 
#plot of salary by gender
salary_plot <- ggplot (salary_data, aes(x=sex, y=salary))+
  geom_point(aes(color=faculty.rank), alpha=0.6)
salary_plot

#plot of salary by faculty rank
facultyrank_plot <- ggplot (salary_data, aes(x=faculty.rank, y=salary))+
  geom_point(aes(color=sex))
facultyrank_plot

# well this doesn't seem to be saying much, not seeing any glaring trends here

# summary table looking at salary by sex and faculty position... interesting? maybe.
avg_salary_sex <- salary_data %>% 
  group_by(sex, faculty.rank) %>% 
  summarize(mean= mean(salary),
            count=n())
avg_salary_sex

# linear model with ALL possible variables

salary_lm1 <- lm (salary ~ sex+faculty.rank+discipline+yrs.since.phd+yrs.service, data=salary_data)

summary(salary_lm1)

# taking out yrs.since.phd, since it likely pretty much same as years.service; also makes no sense that the years of service would have a negative coefficient

salary_lm2 <- lm(salary ~ sex+faculty.rank+discipline+yrs.service, data=salary_data)

summary(salary_lm2)

# yrs.service still has a negative coefficient... this is not logical


# taking out faculty.rank (since rank is mostly just determined by how long they are there?)
salary_lm3 <- lm(salary ~ sex+discipline+yrs.service, data=salary_data)

summary(salary_lm3)

plot(salary_lm3)

```

